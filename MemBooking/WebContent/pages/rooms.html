<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Room</title>
<link rel="stylesheet" type="text/css" href="../easyui/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="../easyui/themes/icon.css">
<link rel="stylesheet" type="text/css" href="../easyui/demo/demo.css">
<script type="text/javascript" src="../easyui/jquery.min.js"></script>
<script type="text/javascript" src="../easyui/jquery.easyui.min.js"></script>
</head>
<body class="easyui-layout">
<div data-options="region:'north',border:false" style="height:60px;background:#B3DFDA;padding:10px"><h2>无垠式代码生成器生成结果</h2></div>
<div data-options="region:'west',split:true,title:'主菜单'" style="width:156px;padding:0px;">
<div class="easyui-accordion" data-options="fit:true,border:false">
<div title="域对象清单" style="padding:0px" data-options="selected:true">
<div id="mmadmin" data-options="inline:true" style="width: 142px; height: 98%; overflow: hidden; left: 0px; top: 0px; outline: none; display: block;" class="menu-top menu-inline menu easyui-fluid" tabindex="0"><div class="menu-line" style="height: 122px;"></div>

<div onclick="window.location='../pages/index.html'" class="menu-item" style="height: 20px;"><div class="menu-text" style="height: 20px; line-height: 20px;">Homepage</div><div class="menu-icon icon-add"></div></div>
<div onclick="window.location='../pages/guests.html'" class="menu-item" style="height: 20px;"><div class="menu-text" style="height: 20px; line-height: 20px;">Guest</div><div class="menu-icon icon-add"></div></div>
<div onclick="window.location='../pages/rooms.html'" class="menu-item" style="height: 20px;"><div class="menu-text" style="height: 20px; line-height: 20px;">Room</div><div class="menu-icon icon-add"></div></div>
<div onclick="window.location='../pages/bookings.html'" class="menu-item" style="height: 20px;"><div class="menu-text" style="height: 20px; line-height: 20px;">Booking</div><div class="menu-icon icon-add"></div></div>
</div>
</div>
</div>
</div>
<div data-options="region:'east',split:true,collapsed:true,title:'属性'" style="width:250px;overflow: hidden">
</div>
<div data-options="region:'south',border:false" style="height:50px;background:#A9FACD;padding:10px;text-align: center">火箭船软件工作室版权所有。作者电邮:jerry_shen_sjf@qq.com QQ群:277689737</div>
<div data-options="region:'center',title:'Room清单'">
<div title="搜索面板" class="easyui-panel" style="width:1120px;height:200px">
<form id="ffsearch" method="post">
<table cellpadding="5">
<tr>
<td>Active:</td><td><input  class='easyui-textbox' type='text' name='active' id='active' value='' data-options="required:false"/></td>
<td>描述:</td><td><input class='easyui-textbox' type='text' name='description' id='description' value='' data-options="required:false"/></td>
<td>Room Name:</td><td><input class='easyui-textbox' type='text' name='roomName' id='roomName' value='' data-options="required:false"/></td></tr>
</tr>
<tr>
<td>Room No.:</td><td><input  class='easyui-textbox' type='text' name='roomNo' id='roomNo' value='' data-options="required:false"/></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td colspan="3"><a href="javascript:void(0)" class="easyui-linkbutton" onclick="searchRoomsByFieldsByPage()">搜索</a></td></tr>
</table>
</form>
</div>
<table id="dg" class="easyui-datagrid" title="Room清单" style="width:1120px;height:400px" data-options="singleSelect:false,url:'../facade/searchRoomsByFieldsByPageFacade',queryParams:params,method:'post',pagination:true,toolbar:toolbar">
<thead>
<tr>
<th data-options="field:'id',checkbox:true">ID</th>
<th data-options="field:'active',width:80">Active</th>
<th data-options="field:'description',width:80">描述</th>
<th data-options="field:'roomName',width:80">Room Name</th>
<th data-options="field:'roomNo',width:80">Room No.</th>
</tr>
</thead>
</table>
</div>

<div class="easyui-window" title="新增Room" id="waddRoom" data-options="iconCls:'icon-save',modal:true,closed:true" style="width:550px;height:600px">
<div style="padding:10px 60px 20px 60px">
<form id="ff" method="post">
<table cellpadding="5">
<tr><td>描述:</td><td><input  class='easyui-textbox' type='text' name='description' id='description' value='' data-options="required:false"/></td></tr>
<tr><td>Room Name:</td><td><input  class='easyui-textbox' type='text' name='roomName' id='roomName' value='' data-options="required:false"/></td></tr>
<tr><td>Room No.:</td><td><input  class='easyui-textbox' type='text' name='roomNo' id='roomNo' value='' data-options="required:false"/></td></tr>
<tr><td>Active:</td><td><input class='easyui-radio' type='radio' name='active' id='active' value='true' checked='true'/>True<input type='radio' class='easyui-radio' name='active' id='active' value='false'/>False</td></tr>
</table>
</form>
<div style="text-align:center;padding:5px">
<a href="javascript:void(0)" class="easyui-linkbutton" onclick="addRoom()">新增</a>
<a href="javascript:void(0)" class="easyui-linkbutton" onclick="clearForm()">清除</a>
<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#waddRoom').window('close')">取消</a>
</div>
</div>

<div class="easyui-window" title="编辑Room" id="wupdateRoom" data-options="iconCls:'icon-save',modal:true,closed:true" style="width:500px;height:500px">
<div style="padding:10px 60px 20px 60px">
<form id="ffedit" method="post">
<input  type='hidden' name='id' id='id' value=''/>
<table cellpadding="5">
<tr><td>描述:</td><td><input  class='easyui-textbox' type='text' name='description' id='description' value='' data-options="required:false"/></td></tr>
<tr><td>Room Name:</td><td><input  class='easyui-textbox' type='text' name='roomName' id='roomName' value='' data-options="required:false"/></td></tr>
<tr><td>Room No.:</td><td><input  class='easyui-textbox' type='text' name='roomNo' id='roomNo' value='' data-options="required:false"/></td></tr>
<tr><td>Active:</td><td><input class='easyui-radio' type='radio' name='active' id='active' value='true' checked='true'/>True<input type='radio' class='easyui-radio' name='active' id='active' value='false'/>False</td></tr>
</table>
</form>
<div style="text-align:center;padding:5px">
<a href="javascript:void(0)" class="easyui-linkbutton" onclick="updateRoom()">编辑</a>
<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#ffedit').form('clear');">清除</a>
<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#wupdateRoom').window('close')">取消</a>
</div>
</div>
</body>
<script type="text/javascript">
var params = {};
var pagesize = 10;
var pagenum = 1;
var toolbar = [
{
	text:'新增',
	iconCls:'icon-add',
	handler:function(){
		$('#waddRoom').window('open');
	}
}
,
{
	text:'编辑',
	iconCls:'icon-edit',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		if (rows.length > 1) {
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		$("#ffedit").find("#id").val(rows[0]["id"]);
		$("#ffedit").find("#description").textbox("setValue",rows[0]["description"]);
		$("#ffedit").find("#roomName").textbox("setValue",rows[0]["roomName"]);
		$("#ffedit").find("#roomNo").textbox("setValue",rows[0]["roomNo"]);
		var checkboxs = $("#ffedit").find("input[name='active']");
		for (var i=0;i<checkboxs.size();i++){
			if (checkboxs.get(i).value == ""+rows[0]["active"]) checkboxs.get(i).checked=true;
		}
		$('#wupdateRoom').window('open');
	}
}
,
{
	text:'软删除',
	iconCls:'icon-remove',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		if (rows.length > 1) {
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		var id = rows[0]["id"];
		softDeleteRoom(id);
	}
}
,
{
	text:'激活',
	iconCls:'icon-tip',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		if (rows.length > 1) {
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		var id = rows[0]["id"];
		activateRoom(id);
	}
}
,
{
	text:'删除',
	iconCls:'icon-remove',
	handler:function(){
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		if ($.messager.confirm("警告","确认要删除选定记录吗？", function(data){
			if (data){
				if (rows.length > 1) {
					$.messager.alert("警告","请选定一条记录！","warning");
					return;
				}
				var id = rows[0]["id"];
				deleteRoom(id);
			}
		}));
}
}
,
{
	text:'切换',
	iconCls:'icon-cut',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		if (rows.length > 1) {
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		var id = rows[0]["id"];
		toggleRoom(id);
	}
}
,
{
	text:'留一切换',
	iconCls:'icon-cut',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		if (rows.length > 1) {
			$.messager.alert("警告","请选定一条记录！","warning");
			return;
		}
		var id = rows[0]["id"];
		toggleOneRoom(id);
	}
}
,'-',
{
	text:'批软删除',
	iconCls:'icon-remove',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定记录！","warning");
			return;
		}
		var ids = "";
		for(var i=0;i<rows.length;i++){
			ids += rows[i]["id"];
			if (i < rows.length-1) ids += ",";
		}
		softDeleteAllRooms(ids);
	}
}
,
{
	text:'批激活',
	iconCls:'icon-tip',
	handler:function(){ 
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定记录！","warning");
			return;
		}
		var ids = "";
		for(var i=0;i<rows.length;i++){
			ids += rows[i]["id"];
			if (i < rows.length-1) ids += ",";
		}
		activateAllRooms(ids);
	}
}
,
{
	text:'批删除',
	iconCls:'icon-remove',
	handler:function(){
		var rows = $("#dg").datagrid("getChecked");
		if (rows == undefined || rows == null || rows.length == 0 ){
			$.messager.alert("警告","请选定记录！","warning");
			return;
		}
		if ($.messager.confirm("警告","确认要删除选定记录吗？",function(data){
			if (data){
				var ids = "";
				for(var i=0;i<rows.length;i++){
					ids += rows[i]["id"];
					if (i < rows.length-1) ids += ",";
				}
				deleteAllRooms(ids);
			}
		}));
	}
}
,
{
	text:'Excel导出',
	iconCls:'icon-sum',
	handler:function(){
		window.location.href="../facade/exportRoomsFacade";
	}
}
];
$(document).ready(function(){
$("#dg").datagrid("load");
});
function clearForm(){
$('#ff').form('clear');
}
function addRoom(){
	if ($("#ff").form("validate")) {
		$.ajax({
			type: "post",
			url: "../facade/addRoomFacade",
			data:{
				active:parseBoolean($("#ff").find("input[name='active']:checked").val()),
				description:$("#ff").find("#description").val(),
				roomName:$("#ff").find("#roomName").val(),
				roomNo:$("#ff").find("#roomNo").val(),
			},
			success: function(data, textStatus) {
				if (data.success) {
					$('#ff').form('clear');
					$("#ff").find("input[name='active']").get(0).checked = true;
					$("#waddRoom").window('close');
					$("#dg").datagrid("load");
				}
				},
			complete : function(XMLHttpRequest, textStatus) {
			},
			error : function(XMLHttpRequest,textStatus,errorThrown) {
				alert("Error:"+textStatus);
				alert(errorThrown.toString());
			}
		});
	}
}

function updateRoom(){
	$.ajax({
		type: "post",
		url: "../facade/updateRoomFacade",
		data:{
			roomNo:$("#ffedit").find("#roomNo").val(),
			description:$("#ffedit").find("#description").val(),
			roomName:$("#ffedit").find("#roomName").val(),
			active:parseBoolean($("#ffedit").find("input[name='active']:checked").val()),
			id:$("#ffedit").find("#id").val(),
		},
		success: function(data, textStatus) {
			if (data.success){
				$('#ffedit').form('clear');
				$("#ffedit").find("input[name='active']").get(0).checked = true;
				$("#wupdateRoom").window('close');
				$("#dg").datagrid("load");
			}
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	}); 
}

function softDeleteRoom(id){
	$.ajax({
		type: "post",
		url: "../facade/softDeleteRoomFacade",
		data: {
			"id":id	
		},
		dataType: 'json',
		success: function(data, textStatus) {
			$("#dg").datagrid("load");
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function activateRoom(id){
	$.ajax({
		type: "post",
		url: "../facade/activateRoomFacade",
		data: {
			"id":id	
		},
		dataType: 'json',
		success: function(data, textStatus) {
			$("#dg").datagrid("load");
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function deleteRoom(id){
	$.ajax({
		type: "post",
		url: "../facade/deleteRoomFacade",
		dataType: 'json',
		data:{"id":id},
		success: function(data, textStatus) {
			$("#dg").datagrid("load");
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	}); 
}

function toggleRoom(id){
	$.ajax({
		type: "post",
		url: "../facade/toggleRoomFacade",
		data: {
			"id":id
		},
		dataType: 'json',
		success: function(data, textStatus) {
			$("#dg").datagrid("load");
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function toggleOneRoom(id){
	$.ajax({
		type: "post",
		url: "../facade/toggleOneRoomFacade",
		data: {
			"id":id
		},
		dataType: 'json',
		success: function(data, textStatus) {
			$("#dg").datagrid("load");
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function softDeleteAllRooms(ids){
	$.ajax({
		type: "post",
			url: "../facade/softDeleteAllRoomsFacade",
			data: {
				ids:ids
			},
			dataType: 'json',
			success: function(data, textStatus) {
				$("#dg").datagrid("load");
			},
			complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function activateAllRooms(ids){
	$.ajax({
		type: "post",
			url: "../facade/activateAllRoomsFacade",
			data: {
				ids:ids
			},
			dataType: 'json',
			success: function(data, textStatus) {
				$("#dg").datagrid("load");
			},
			complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function deleteAllRooms(ids){
	$.ajax({
		type: "post",
		url: "../facade/deleteAllRoomsFacade",
		data: {
			ids:ids
		},
		dataType: 'json',
		success: function(data, textStatus) {
			$("#dg").datagrid("load");
		},
		complete : function(XMLHttpRequest, textStatus) {
		},
		error : function(XMLHttpRequest,textStatus,errorThrown) {
			alert("Error:"+textStatus);
			alert(errorThrown.toString());
		}
	});
}

function searchRoomsByFieldsByPage(){
	params = {
		active:parseBoolean($("#ffsearch").find("#active").val()),
		description:$("#ffsearch").find("#description").val(),
		roomName:$("#ffsearch").find("#roomName").val(),
		roomNo:$("#ffsearch").find("#roomNo").val(),
	};
	$("#dg").datagrid({queryParams:params});
}

function parseBoolean(val){
	if (val == undefined|| val == null) return false;
	var isInt = /^(-}+)?\d+$/.test(val);
	if (isInt&& val == "0") return false;
	else if (isInt&& val == "1") return true;
	else if (val.toLowerCase() == "false") return false;
	else if (val.toLowerCase() == "true") return true;
	else if (val.toLowerCase() == "f") return false;
	else if (val.toLowerCase() == "t") return true;
	else if (val.toLowerCase() == "n") return false;
	else if (val.toLowerCase() == "y") return true;
	else if (val.toLowerCase() == "no") return false;
	else if (val.toLowerCase() == "yes") return true;
	else return "";
}
function isBlank(val){
	if (val == undefined|| val == null || val == "") return true;
	else return false;
}
function checkRadioBoxValue(control,field,fieldvalue){
	var checkboxs = $("#"+control).find("input[name='"+field+"']");
	for (var i=0;i<checkboxs.size();i++){
		if (checkboxs.get(i).value == ""+fieldvalue) checkboxs.get(i).checked=true;
	}
}
</script>
</html>
